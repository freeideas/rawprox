# Untested Req
**Timestamp:** 2025-11-02-13-53-36

---

## Prompt

Please follow these instructions: @./the-system/prompts/WRITE_TEST.md

Create test for requirement:
  $REQ_ID: $REQ_FILE_019
  Flow file: reqs\multiple-log-destinations.md
  Source: ./readme/LOG_FORMAT.md (Section: "Logging Control Events")
  Requirement text: When logging starts to multiple destinations, emit a separate `start-logging` event for each destination.


---

## Response

Perfect! Let me provide a summary:

---

## Test Created

**Test file:** `tests/failing/test_multiple_log_destinations.py`

**Flow tested:** Multiple Log Destinations (`reqs/multiple-log-destinations.md`)

**Requirements covered:**
- `$REQ_STARTUP_007` -- Start with single port rule
- `$REQ_FILE_025` -- Multiple destinations (STDOUT + 2 directories)
- `$REQ_FILE_019` -- Separate start-logging event for each destination
- `$REQ_FILE_020` -- All events written to all destinations
- `$REQ_PROXY_017` -- Accept TCP connections
- `$REQ_PROXY_022` -- Forward traffic bidirectionally
- `$REQ_STDOUT_015` -- Connection open events
- `$REQ_STDOUT_020` -- Traffic data events
- `$REQ_STDOUT_017` -- Connection close events
- `$REQ_FILE_021` -- Independent directory buffers
- `$REQ_SHUTDOWN_008` -- Ctrl-C shutdown (skipped -- untestable in automation)
- `$REQ_FILE_022` -- Multiple stop-logging events (tested on kill)
- `$REQ_SHUTDOWN_012` -- Close all connections
- `$REQ_SHUTDOWN_016` -- Stop all listeners
- `$REQ_SHUTDOWN_020` -- Flush buffered logs

**Test approach:**
1. Starts RawProx with 3 log destinations (STDOUT + 2 directories)
2. Verifies 3 separate `start-logging` events are emitted
3. Opens TCP connection through proxy, sends HTTP request
4. Verifies connection open, data, and close events in STDOUT
5. Verifies all events are written to both directory destinations
6. Verifies independent buffer flushing for each directory
7. Kills process and verifies logs were flushed to disk

